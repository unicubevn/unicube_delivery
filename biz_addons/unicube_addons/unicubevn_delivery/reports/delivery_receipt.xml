<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="document_tax_totals">
            <!--
                Generic template to display tax totals in pdf reports.
                Used by invoices, SO and PO.

                ARGUMENTS:
                - tax_totals: dict in the form generated by account.move's _get_tax_totals.
            -->
            <t t-foreach="tax_totals['subtotals']" t-as="subtotal">
                <tr class="border-black o_subtotal">
                    <td>
                        <strong t-esc="subtotal['name']"/>
                    </td>

                    <td class="text-right">
                        <span t-att-class="oe_subtotal_footer_separator" t-esc="subtotal['formatted_amount']"/>
                    </td>
                </tr>

                <t t-set="subtotal_to_show" t-value="subtotal['name']"/>
                <t t-call="account.tax_groups_totals"/>
            </t>

            <!--Total amount with all taxes-->
            <tr class="border-black o_total">
                <td>
                    <strong>Total</strong>
                </td>
                <td class="text-right">
                    <span t-esc="tax_totals['formatted_amount_total']"/>
                </td>
            </tr>
        </template>

        <template id="tax_groups_totals">
            <!--
                Generic template to display a list of tax groups with the related amounts.

                ARGUMENTS:
                - tax_totals: dict in the form generated by account.move's _get_tax_totals.
                - subtotal_to_show: The subtotal we need to render the groups from
            -->
            <t t-foreach="tax_totals['groups_by_subtotal'][subtotal_to_show]" t-as="amount_by_group">
                <tr>
                    <t t-if="len(tax_totals['groups_by_subtotal'][subtotal_to_show]) > 1">
                        <td>
                            <span t-esc="amount_by_group['tax_group_name']"/>
                            <span class="text-nowrap">
                                on
                                <t t-esc="amount_by_group['formatted_tax_group_base_amount']"/>
                            </span>
                        </td>
                        <td class="text-right o_price_total">
                            <span class="text-nowrap" t-esc="amount_by_group['formatted_tax_group_amount']"/>
                        </td>
                    </t>
                    <t t-else="">
                        <td>
                            <span class="text-nowrap" t-esc="amount_by_group['tax_group_name']"/>
                        </td>
                        <td class="text-right o_price_total">
                            <span class="text-nowrap" t-esc="amount_by_group['formatted_tax_group_amount']"/>
                        </td>
                    </t>
                </tr>
            </t>
        </template>

        <template id="package_receipt">
            <button class="print_button btn btn-primary no-print" onclick="print_receipt('unicube_receipt_page')">Direct
                Print Receipt
            </button>
            <div class="unicube_receipt" style="display: flex;
                    flex-direction: column;
                    align-items: center;
                    padding: 1rem;">
                <t t-call="web.basic_layout">
                    <t t-set="o" t-value="o.with_context(lang=lang)"/>

                    <div class="page bean_page unicube_receipt_page" style="min-width:396px; min-height:559px">
                    <!--                        <div class="container">-->
                    <table style="" class="table table-bordered">
                    <tr id="company_info">
                        <td colspan="2">
                            <div class="row">
                                <div class="col-8" id="logo">
                                    <p>
                                        <img t-att-src="image_data_uri(o.company_id.logo)"
                                        />
                                        <t t-esc="o.company_id.name"/>

                                    </p>

                                    <p>
                                        <small>Delivery receipt id:</small>
                                        <br/>
                                        <span t-esc="o.name" id="delivery_id"/>
                                    </p>
                                </div>
                                <div class="col-4" id="qr_place">
                                    <img t-att-src="o.qr_raw_data"/>

                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr id="addresses">
                    <td>
                        <p>
                            <small>From:</small>
                            <b>
                                <t t-esc="o.partner_id.complete_name"/>
                            </b>
                            <br/>
                            <t t-esc="o.partner_id.contact_address_complete"/>
                            <br/>
                            <t t-esc="o.partner_id.mobile"/>
                            <br/>
                            <t t-esc="o.partner_id.phone"/>
                            <br/>
                        </p>
                    </td>
                    <td>
                    <p>
                    <small>To:</small>
                        <t t-if="o.owner_id">
                    <b><t t-esc="o.owner_id.complete_name"/></b>
                    <br/>
                    <t t-esc="o.owner_id.contact_address_complete"/>
                    <br/>
                    <t t-esc="o.owner_id.mobile"/>
                    <br/>
                    <t t-esc="o.owner_id.phone"/>
                    <br/>
                </t>
            </p>
        </td>
    </tr>
    <tr id="package_desc">
        <td colspan="2">
            <p>
                <small>Description:</small>
            </p>
            <p>...</p>
        </td>
    </tr>
    <tr id="price_info">
        <td>
            <p>
                <small>Package Price:</small>
                <br/>
                <span id="package_value" t-esc="o.total_package_price"
                      t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'/>

            </p>
        </td>

        <td>
            <p>Customer Signature:</p>
        </td>
    </tr>
</table>
        <!--                        </div>-->
        </div>

        </t>
        </div>
        </template>


<template id="delivery_receipt_template_">
<!--            <div class="bean_receipt">-->
<t t-call="web.html_container">
    <t t-foreach="docs" t-as="o">
        <t t-set="lang" t-value="o.partner_id.lang"/>
        <t t-set="print_with_payments" t-value="True"/>
        <div class="article" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id"
             t-att-data-oe-lang="o and o.env.context.get('lang')"
             style="background: #e5e5e5 !important; display: flex;flex-direction: column;">
            <t t-call="unicubevn_delivery.package_receipt" t-lang="lang"/>
        </div>

    </t>
</t>
<!--            </div>-->

</template>

        <!--We need to create the following empty report template for the action report
            "action_account_original_vendor_bill" to work. The action is merging the
            original vendor bill(s) that were used to create the vendor bill(s) into one PDF. -->
        <!--        <template id="report_original_vendor_bill">-->
        <!--            <t t-call="web.html_container">-->
        <!--                <t t-foreach="docs" t-as="o">-->
        <!--                    <div class="article" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id"-->
        <!--                         t-att-data-oe-lang="o and o.env.context.get('lang')"></div>-->
        <!--                </t>-->
        <!--            </t>-->
        <!--        </template>-->

        <!-- Allow edits (e.g. studio) without changing the often inherited base template -->
<template id="delivery_receipt_template" inherit_id="unicubevn_delivery.delivery_receipt_template_"
          primary="True"/>

<record id="delivery_receipt" model="ir.actions.report">
<field name="name">Delivery receipt</field>
<field name="model">stock.picking</field>
<field name="report_type">qweb-html</field>
<field name="report_name">unicubevn_delivery.delivery_receipt_template</field>
<field name="paperformat_id" ref="a6_receipt"/>
<field name="binding_model_id" ref="stock.model_stock_picking"/>
<field name="binding_type">report</field>

</record>
        </data>
        </odoo>